name: main

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: macos-12

    strategy:
      matrix:
        ios: ['14.0', '15.0', '16.0']

    steps:
      - name: Check Xcode version
        run: xcodebuild -version

      - name: Install iOS simulator
        run: |
         brew install xcodesorg/made/xcodes
         xcodes runtimes install "iOS ${{ matrix.ios }}"

      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Test with xcodebuild
        run: xcodebuild -project my-app/my-app.xcodeproj -scheme my-appTests -destination "platform=iOS Simulator,OS=${{ matrix.ios }},name=iPhone 13" test
